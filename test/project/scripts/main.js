var k=Object.defineProperty;var w=s=>{throw TypeError(s)};var m=(s,t,e)=>t in s?k(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var d=(s,t,e)=>m(s,typeof t!="symbol"?t+"":t,e),c=(s,t,e)=>t.has(s)||w("Cannot "+e);var r=(s,t,e)=>(c(s,t,"read from private field"),e?e.call(s):t.get(s)),h=(s,t,e)=>t.has(s)?w("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(s):t.set(s,e),g=(s,t,e,n)=>(c(s,t,"write to private field"),n?n.call(s,e):t.set(s,e),e),L=(s,t,e)=>(c(s,t,"access private method"),e);var o,i,u=class{constructor(t){h(this,o);h(this,i,new Map);g(this,o,t)}on(t,e){r(this,o).addEventListener(t,e);let n=r(this,i).get(t);return n||(r(this,i).set(t,new Set([e])),n=r(this,i).get(t)),n.add(e),()=>{r(this,o).removeEventListener(t,e),n.delete(e),n.size===0&&r(this,i).delete(t)}}release(){for(let[t,e]of r(this,i))for(let n of e)r(this,o).removeEventListener(t,n)}};o=new WeakMap,i=new WeakMap;var a,y,l=class extends u{constructor(e){super(e);h(this,a);d(this,"runtime");d(this,"tickHandlers",new Set);this.runtime=e,this.on("beforeprojectstart",()=>this.beforeStart()),this.on("afterprojectstart",()=>this.onStart()),this.on("tick",()=>L(this,a,y).call(this))}onTick(e){return this.tickHandlers.add(e),()=>{this.tickHandlers.delete(e)}}addInstances(e){for(let[n,v]of Object.entries(e))this.runtime.objects[n].setInstanceClass(v)}addPromises(e){for(let n of e)this.runtime.sdk.addLoadPromise(n)}};a=new WeakSet,y=function(){for(let e of this.tickHandlers)e()};var f=class{lerp(t,e,n){return t+(e-t)*n}global(t,e){globalThis[t]=e}};new f;var p=class extends l{beforeStart(){this.on("tick",()=>this.tick())}onStart(){}tick(){}},b;runOnStartup(s=>{b=new p(s)});export{b as app};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi5qcyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiY2xhc3MgRXZlbnRzSGFuZGxlciB7XG4gICAgI2V2ZW50cyA9IG5ldyBNYXAoKTtcbiAgICBvbihldmVudCwgaGFuZGxlcikge1xuICAgICAgICBsZXQgaGFuZGxlcnMgPSB0aGlzLiNldmVudHMuZ2V0KGV2ZW50KTtcbiAgICAgICAgaWYgKCFoYW5kbGVycykge1xuICAgICAgICAgICAgdGhpcy4jZXZlbnRzLnNldChldmVudCwgbmV3IFNldChbXG4gICAgICAgICAgICAgICAgaGFuZGxlclxuICAgICAgICAgICAgXSkpO1xuICAgICAgICAgICAgaGFuZGxlcnMgPSB0aGlzLiNldmVudHMuZ2V0KGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgICBoYW5kbGVycy5hZGQoaGFuZGxlcik7XG4gICAgICAgIHJldHVybiAoKT0+e1xuICAgICAgICAgICAgaGFuZGxlcnMuZGVsZXRlKGhhbmRsZXIpO1xuICAgICAgICAgICAgaWYgKGhhbmRsZXJzLnNpemUgPT09IDApIHRoaXMuI2V2ZW50cy5kZWxldGUoZXZlbnQpO1xuICAgICAgICB9O1xuICAgIH1cbiAgICByZWxlYXNlKCkge1xuICAgICAgICB0aGlzLiNldmVudHMuY2xlYXIoKTtcbiAgICB9XG4gICAgZW1pdChldmVudCwgLi4uZGF0YSkge1xuICAgICAgICBjb25zdCBoYW5kbGVycyA9IHRoaXMuI2V2ZW50cy5nZXQoZXZlbnQpO1xuICAgICAgICBpZiAoIWhhbmRsZXJzKSByZXR1cm47XG4gICAgICAgIGZvciAoY29uc3QgaGFuZGxlciBvZiBoYW5kbGVycyl7XG4gICAgICAgICAgICBoYW5kbGVyKGRhdGFbMF0pO1xuICAgICAgICB9XG4gICAgfVxufVxuY2xhc3MgQzNFdmVudHNIYW5kbGVyIHtcbiAgICAjcmVmO1xuICAgICNldmVudHMgPSBuZXcgTWFwKCk7XG4gICAgY29uc3RydWN0b3IocmVmKXtcbiAgICAgICAgdGhpcy4jcmVmID0gcmVmO1xuICAgIH1cbiAgICBvbihldmVudCwgaGFuZGxlcikge1xuICAgICAgICB0aGlzLiNyZWYuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlcik7XG4gICAgICAgIGxldCBoYW5kbGVycyA9IHRoaXMuI2V2ZW50cy5nZXQoZXZlbnQpO1xuICAgICAgICBpZiAoIWhhbmRsZXJzKSB7XG4gICAgICAgICAgICB0aGlzLiNldmVudHMuc2V0KGV2ZW50LCBuZXcgU2V0KFtcbiAgICAgICAgICAgICAgICBoYW5kbGVyXG4gICAgICAgICAgICBdKSk7XG4gICAgICAgICAgICBoYW5kbGVycyA9IHRoaXMuI2V2ZW50cy5nZXQoZXZlbnQpO1xuICAgICAgICB9XG4gICAgICAgIGhhbmRsZXJzLmFkZChoYW5kbGVyKTtcbiAgICAgICAgcmV0dXJuICgpPT57XG4gICAgICAgICAgICB0aGlzLiNyZWYucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlcik7XG4gICAgICAgICAgICBoYW5kbGVycy5kZWxldGUoaGFuZGxlcik7XG4gICAgICAgICAgICBpZiAoaGFuZGxlcnMuc2l6ZSA9PT0gMCkgdGhpcy4jZXZlbnRzLmRlbGV0ZShldmVudCk7XG4gICAgICAgIH07XG4gICAgfVxuICAgIHJlbGVhc2UoKSB7XG4gICAgICAgIGZvciAoY29uc3QgW2V2ZW50LCBoYW5kbGVyc10gb2YgdGhpcy4jZXZlbnRzKXtcbiAgICAgICAgICAgIGZvciAoY29uc3QgaGFuZGxlciBvZiBoYW5kbGVycyl7XG4gICAgICAgICAgICAgICAgdGhpcy4jcmVmLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuY2xhc3MgQzNBcHAgZXh0ZW5kcyBDM0V2ZW50c0hhbmRsZXIge1xuICAgIHJ1bnRpbWU7XG4gICAgdGlja0hhbmRsZXJzID0gbmV3IFNldCgpO1xuICAgIGNvbnN0cnVjdG9yKHJ1bnRpbWUpe1xuICAgICAgICBzdXBlcihydW50aW1lKTtcbiAgICAgICAgdGhpcy5ydW50aW1lID0gcnVudGltZTtcbiAgICAgICAgdGhpcy5vbignYmVmb3JlcHJvamVjdHN0YXJ0JywgKCk9PnRoaXMuYmVmb3JlU3RhcnQoKSk7XG4gICAgICAgIHRoaXMub24oJ2FmdGVycHJvamVjdHN0YXJ0JywgKCk9PnRoaXMub25TdGFydCgpKTtcbiAgICAgICAgdGhpcy5vbigndGljaycsICgpPT50aGlzLiNvblRpY2soKSk7XG4gICAgfVxuICAgIG9uVGljayhoYW5kbGVyKSB7XG4gICAgICAgIHRoaXMudGlja0hhbmRsZXJzLmFkZChoYW5kbGVyKTtcbiAgICAgICAgcmV0dXJuICgpPT57XG4gICAgICAgICAgICB0aGlzLnRpY2tIYW5kbGVycy5kZWxldGUoaGFuZGxlcik7XG4gICAgICAgIH07XG4gICAgfVxuICAgIGFkZEluc3RhbmNlcyhpbnN0YW5jZXMpIHtcbiAgICAgICAgZm9yIChjb25zdCBbb2JqZWN0TmFtZSwga2xhc3NdIG9mIE9iamVjdC5lbnRyaWVzKGluc3RhbmNlcykpe1xuICAgICAgICAgICAgdGhpcy5ydW50aW1lLm9iamVjdHNbb2JqZWN0TmFtZV0uc2V0SW5zdGFuY2VDbGFzcyhrbGFzcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYWRkUHJvbWlzZXMocHJvbWlzZXMpIHtcbiAgICAgICAgZm9yIChjb25zdCBwcm9taXNlIG9mIHByb21pc2VzKXtcbiAgICAgICAgICAgIHRoaXMucnVudGltZS5zZGsuYWRkTG9hZFByb21pc2UocHJvbWlzZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgI29uVGljaygpIHtcbiAgICAgICAgZm9yIChjb25zdCBoYW5kbGVyIG9mIHRoaXMudGlja0hhbmRsZXJzKXtcbiAgICAgICAgICAgIGhhbmRsZXIoKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmNsYXNzIEtleWJvYXJkU3lzdGVtIGV4dGVuZHMgQzNFdmVudHNIYW5kbGVyIHtcbiAgICBwcmVzc0xpc3RlbmVycyA9IG5ldyBNYXAoKTtcbiAgICByZWxlYXNlTGlzdGVuZXJlcyA9IG5ldyBNYXAoKTtcbiAgICBrZXlzID0gbmV3IE1hcCgpO1xuICAgIHByZXZpb3VzS2V5cyA9IG5ldyBNYXAoKTtcbiAgICBjb25zdHJ1Y3RvcihydW50aW1lKXtcbiAgICAgICAgc3VwZXIocnVudGltZSk7XG4gICAgICAgIHRoaXMub24oJ2tleWRvd24nLCAoZSk9PnRoaXMuI29uS2V5RG93bihlKSk7XG4gICAgICAgIHRoaXMub24oJ2tleXVwJywgKGUpPT50aGlzLiNvbktleVVwKGUpKTtcbiAgICAgICAgdGhpcy5vbigndGljaycsICgpPT50aGlzLiN1cGRhdGUoKSk7XG4gICAgfVxuICAgIG9uS2V5UHJlc3NlZChrZXksIGhhbmRsZXIpIHtcbiAgICAgICAgbGV0IGhhbmRsZXJzID0gdGhpcy5wcmVzc0xpc3RlbmVycy5nZXQoa2V5KTtcbiAgICAgICAgaWYgKCFoYW5kbGVycykge1xuICAgICAgICAgICAgdGhpcy5wcmVzc0xpc3RlbmVycy5zZXQoa2V5LCBuZXcgU2V0KCkpO1xuICAgICAgICAgICAgaGFuZGxlcnMgPSB0aGlzLnByZXNzTGlzdGVuZXJzLmdldChrZXkpO1xuICAgICAgICB9XG4gICAgICAgIGhhbmRsZXJzLmFkZChoYW5kbGVyKTtcbiAgICAgICAgcmV0dXJuICgpPT57XG4gICAgICAgICAgICBoYW5kbGVycy5kZWxldGUoaGFuZGxlcik7XG4gICAgICAgIH07XG4gICAgfVxuICAgIG9uS2V5UmVsZWFzZWQoa2V5LCBoYW5kbGVyKSB7XG4gICAgICAgIGxldCBoYW5kbGVycyA9IHRoaXMucmVsZWFzZUxpc3RlbmVyZXMuZ2V0KGtleSk7XG4gICAgICAgIGlmICghaGFuZGxlcnMpIHtcbiAgICAgICAgICAgIHRoaXMucmVsZWFzZUxpc3RlbmVyZXMuc2V0KGtleSwgbmV3IFNldCgpKTtcbiAgICAgICAgICAgIGhhbmRsZXJzID0gdGhpcy5yZWxlYXNlTGlzdGVuZXJlcy5nZXQoa2V5KTtcbiAgICAgICAgfVxuICAgICAgICBoYW5kbGVycy5hZGQoaGFuZGxlcik7XG4gICAgICAgIHJldHVybiAoKT0+e1xuICAgICAgICAgICAgaGFuZGxlcnMuZGVsZXRlKGhhbmRsZXIpO1xuICAgICAgICB9O1xuICAgIH1cbiAgICBpc0tleVByZXNzZWQoa2V5KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmtleXMuZ2V0KGtleSkgPT09ICdwcmVzc2VkJztcbiAgICB9XG4gICAgaXNLZXlSZWxlYXNlZChrZXkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMua2V5cy5nZXQoa2V5KSA9PT0gJ3VwJztcbiAgICB9XG4gICAgI29uS2V5RG93bihlKSB7XG4gICAgICAgIGNvbnN0IHByZXZpb3VzU3RhdGUgPSB0aGlzLmtleXMuZ2V0KGUuY29kZSk7XG4gICAgICAgIGlmIChwcmV2aW91c1N0YXRlICE9PSAnZG93bicpIHtcbiAgICAgICAgICAgIHRoaXMua2V5cy5zZXQoZS5jb2RlLCAnZG93bicpO1xuICAgICAgICAgICAgY29uc3QgaGFuZGxlcnMgPSB0aGlzLnByZXNzTGlzdGVuZXJzLmdldChlLmNvZGUpO1xuICAgICAgICAgICAgaWYgKCFoYW5kbGVycykgcmV0dXJuO1xuICAgICAgICAgICAgZm9yIChjb25zdCBoYW5kbGVyIG9mIGhhbmRsZXJzKXtcbiAgICAgICAgICAgICAgICBoYW5kbGVyKGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgICNvbktleVVwKGUpIHtcbiAgICAgICAgdGhpcy5rZXlzLnNldChlLmNvZGUsICd1cCcpO1xuICAgICAgICBjb25zdCBoYW5kbGVycyA9IHRoaXMucmVsZWFzZUxpc3RlbmVyZXMuZ2V0KGUuY29kZSk7XG4gICAgICAgIGlmICghaGFuZGxlcnMpIHJldHVybjtcbiAgICAgICAgZm9yIChjb25zdCBoYW5kbGVyIG9mIGhhbmRsZXJzKXtcbiAgICAgICAgICAgIGhhbmRsZXIoZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgI3VwZGF0ZSgpIHtcbiAgICAgICAgdGhpcy5wcmV2aW91c0tleXMgPSBuZXcgTWFwKHRoaXMua2V5cyk7XG4gICAgICAgIHRoaXMua2V5cy5mb3JFYWNoKChzdGF0ZSwga2V5KT0+e1xuICAgICAgICAgICAgaWYgKHN0YXRlID09PSAnZG93bicgJiYgdGhpcy5wcmV2aW91c0tleXMuZ2V0KGtleSkgPT09ICdkb3duJykge1xuICAgICAgICAgICAgICAgIHRoaXMua2V5cy5zZXQoa2V5LCAncHJlc3NlZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59XG5jbGFzcyBQb3NpdGlvbiB7XG4gICAgeDtcbiAgICB5O1xuICAgIGNvbnN0cnVjdG9yKHgsIHkpe1xuICAgICAgICB0aGlzLnggPSB4O1xuICAgICAgICB0aGlzLnkgPSB5O1xuICAgIH1cbiAgICBhcnJheSgpIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIHRoaXMueCxcbiAgICAgICAgICAgIHRoaXMueVxuICAgICAgICBdO1xuICAgIH1cbn1cbmNvbnN0IGJ1dHRvbnMgPSB7XG4gICAgbGVmdDogMCxcbiAgICBtaWRkbGU6IDEsXG4gICAgcmlnaHQ6IDIsXG4gICAgZm91cnRoOiAzLFxuICAgIGZpZnRoOiA0XG59O1xuY2xhc3MgTW91c2VTeXN0ZW0gZXh0ZW5kcyBDM0V2ZW50c0hhbmRsZXIge1xuICAgIG1vdmVIYW5kbGVycyA9IG5ldyBTZXQoKTtcbiAgICBwcmVzc0xpc3RlbmVycyA9IG5ldyBNYXAoKTtcbiAgICByZWxlYXNlTGlzdGVuZXJlcyA9IG5ldyBNYXAoKTtcbiAgICB3aGVlbExpc3RlbmVycyA9IG5ldyBNYXAoKTtcbiAgICBidXR0b25zID0gbmV3IE1hcCgpO1xuICAgIHByZXZpb3VzQnV0dG9ucyA9IG5ldyBNYXAoKTtcbiAgICBzdGFydCA9IG5ldyBQb3NpdGlvbigwLCAwKTtcbiAgICBjdXJyZW50ID0gbmV3IFBvc2l0aW9uKDAsIDApO1xuICAgIHByZXZpb3VzID0gbmV3IFBvc2l0aW9uKDAsIDApO1xuICAgIGVuZCA9IG5ldyBQb3NpdGlvbigwLCAwKTtcbiAgICBjb25zdHJ1Y3RvcihydW50aW1lKXtcbiAgICAgICAgc3VwZXIocnVudGltZSk7XG4gICAgICAgIHRoaXMub24oJ21vdXNlZG93bicsIChlKT0+dGhpcy4jb25Eb3duKGUpKTtcbiAgICAgICAgdGhpcy5vbignbW91c2Vtb3ZlJywgKGUpPT50aGlzLiNvbk1vdmUoZSkpO1xuICAgICAgICB0aGlzLm9uKCdtb3VzZXVwJywgKGUpPT50aGlzLiNvblVwKGUpKTtcbiAgICAgICAgdGhpcy5vbignd2hlZWwnLCAoZSk9PnRoaXMuI29uV2hlZWwoZSkpO1xuICAgICAgICB0aGlzLm9uKCd0aWNrJywgKCk9PnRoaXMuI3VwZGF0ZSgpKTtcbiAgICB9XG4gICAgb25Nb3ZlKGhhbmRsZXIpIHtcbiAgICAgICAgdGhpcy5tb3ZlSGFuZGxlcnMuYWRkKGhhbmRsZXIpO1xuICAgICAgICByZXR1cm4gKCk9PntcbiAgICAgICAgICAgIHRoaXMubW92ZUhhbmRsZXJzLmRlbGV0ZShoYW5kbGVyKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgb25CdXR0b25QcmVzc2VkKGJ1dHRvbiwgaGFuZGxlcikge1xuICAgICAgICBjb25zdCBrZXkgPSBidXR0b24gPT09ICdhbnknID8gJ2FueScgOiBidXR0b25zW2J1dHRvbl07XG4gICAgICAgIGxldCBoYW5kbGVycyA9IHRoaXMucHJlc3NMaXN0ZW5lcnMuZ2V0KGtleSk7XG4gICAgICAgIGlmICghaGFuZGxlcnMpIHtcbiAgICAgICAgICAgIHRoaXMucHJlc3NMaXN0ZW5lcnMuc2V0KGtleSwgbmV3IFNldCgpKTtcbiAgICAgICAgICAgIGhhbmRsZXJzID0gdGhpcy5wcmVzc0xpc3RlbmVycy5nZXQoa2V5KTtcbiAgICAgICAgfVxuICAgICAgICBoYW5kbGVycy5hZGQoaGFuZGxlcik7XG4gICAgICAgIHJldHVybiAoKT0+e1xuICAgICAgICAgICAgaGFuZGxlcnMuZGVsZXRlKGhhbmRsZXIpO1xuICAgICAgICB9O1xuICAgIH1cbiAgICBvbkJ1dHRvblJlbGVhc2VkKGJ1dHRvbiwgaGFuZGxlcikge1xuICAgICAgICBjb25zdCBrZXkgPSBidXR0b24gPT09ICdhbnknID8gJ2FueScgOiBidXR0b25zW2J1dHRvbl07XG4gICAgICAgIGxldCBoYW5kbGVycyA9IHRoaXMucmVsZWFzZUxpc3RlbmVyZXMuZ2V0KGtleSk7XG4gICAgICAgIGlmICghaGFuZGxlcnMpIHtcbiAgICAgICAgICAgIHRoaXMucmVsZWFzZUxpc3RlbmVyZXMuc2V0KGtleSwgbmV3IFNldCgpKTtcbiAgICAgICAgICAgIGhhbmRsZXJzID0gdGhpcy5yZWxlYXNlTGlzdGVuZXJlcy5nZXQoa2V5KTtcbiAgICAgICAgfVxuICAgICAgICBoYW5kbGVycy5hZGQoaGFuZGxlcik7XG4gICAgICAgIHJldHVybiAoKT0+e1xuICAgICAgICAgICAgaGFuZGxlcnMuZGVsZXRlKGhhbmRsZXIpO1xuICAgICAgICB9O1xuICAgIH1cbiAgICBvbk1vdXNlV2hlZWwoZGlyZWN0aW9uLCBoYW5kbGVyKSB7XG4gICAgICAgIGxldCBoYW5kbGVycyA9IHRoaXMud2hlZWxMaXN0ZW5lcnMuZ2V0KGRpcmVjdGlvbik7XG4gICAgICAgIGlmICghaGFuZGxlcnMpIHtcbiAgICAgICAgICAgIHRoaXMud2hlZWxMaXN0ZW5lcnMuc2V0KGRpcmVjdGlvbiwgbmV3IFNldCgpKTtcbiAgICAgICAgICAgIGhhbmRsZXJzID0gdGhpcy53aGVlbExpc3RlbmVycy5nZXQoZGlyZWN0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICBoYW5kbGVycy5hZGQoaGFuZGxlcik7XG4gICAgICAgIHJldHVybiAoKT0+e1xuICAgICAgICAgICAgaGFuZGxlcnMuZGVsZXRlKGhhbmRsZXIpO1xuICAgICAgICB9O1xuICAgIH1cbiAgICBpc0J1dHRvblByZXNzZWQoYnV0dG9uKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJ1dHRvbnMuZ2V0KGJ1dHRvbnNbYnV0dG9uXSkgPT09ICdwcmVzc2VkJztcbiAgICB9XG4gICAgaXNCdXR0b25SZWxlYXNlZChidXR0b24pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYnV0dG9ucy5nZXQoYnV0dG9uc1tidXR0b25dKSA9PT0gJ3VwJztcbiAgICB9XG4gICAgI29uV2hlZWwoZSkge1xuICAgICAgICBjb25zdCBkaXJlY3Rpb24gPSBlLmRlbHRhWSA+IDAgPyAnZG93bicgOiAndXAnO1xuICAgICAgICBjb25zdCBoYW5kbGVycyA9IHRoaXMud2hlZWxMaXN0ZW5lcnMuZ2V0KGRpcmVjdGlvbik7XG4gICAgICAgIGlmICghaGFuZGxlcnMpIHJldHVybjtcbiAgICAgICAgZm9yIChjb25zdCBoYW5kbGVyIG9mIGhhbmRsZXJzKXtcbiAgICAgICAgICAgIGhhbmRsZXIoZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgI29uRG93bihlKSB7XG4gICAgICAgIHRoaXMuc3RhcnQueCA9IGUuY2xpZW50WDtcbiAgICAgICAgdGhpcy5zdGFydC55ID0gZS5jbGllbnRZO1xuICAgICAgICBjb25zdCBwcmV2aW91c1N0YXRlID0gdGhpcy5idXR0b25zLmdldChlLmJ1dHRvbik7XG4gICAgICAgIGlmIChwcmV2aW91c1N0YXRlICE9PSAnZG93bicpIHtcbiAgICAgICAgICAgIHRoaXMuYnV0dG9ucy5zZXQoZS5idXR0b24sICdkb3duJyk7XG4gICAgICAgICAgICBjb25zdCBoYW5kbGVycyA9IHRoaXMucHJlc3NMaXN0ZW5lcnMuZ2V0KGUuYnV0dG9uKTtcbiAgICAgICAgICAgIGlmIChoYW5kbGVycykge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaGFuZGxlciBvZiBoYW5kbGVycyl7XG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZXIoZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgYW55SGFuZGxlcnMgPSB0aGlzLnByZXNzTGlzdGVuZXJzLmdldCgnYW55Jyk7XG4gICAgICAgICAgICBpZiAoYW55SGFuZGxlcnMpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGhhbmRsZXIgb2YgYW55SGFuZGxlcnMpe1xuICAgICAgICAgICAgICAgICAgICBoYW5kbGVyKGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAjb25Nb3ZlKGUpIHtcbiAgICAgICAgdGhpcy5wcmV2aW91cy54ID0gdGhpcy5jdXJyZW50Lng7XG4gICAgICAgIHRoaXMucHJldmlvdXMueSA9IHRoaXMuY3VycmVudC55O1xuICAgICAgICB0aGlzLmN1cnJlbnQueCA9IGUuY2xpZW50WDtcbiAgICAgICAgdGhpcy5jdXJyZW50LnkgPSBlLmNsaWVudFk7XG4gICAgICAgIGZvciAoY29uc3QgaGFuZGxlciBvZiB0aGlzLm1vdmVIYW5kbGVycyl7XG4gICAgICAgICAgICBoYW5kbGVyKGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgICNvblVwKGUpIHtcbiAgICAgICAgdGhpcy5lbmQueCA9IGUuY2xpZW50WDtcbiAgICAgICAgdGhpcy5lbmQueSA9IGUuY2xpZW50WTtcbiAgICAgICAgdGhpcy5idXR0b25zLnNldChlLmJ1dHRvbiwgJ3VwJyk7XG4gICAgICAgIGNvbnN0IGhhbmRsZXJzID0gdGhpcy5yZWxlYXNlTGlzdGVuZXJlcy5nZXQoZS5idXR0b24pO1xuICAgICAgICBpZiAoaGFuZGxlcnMpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgaGFuZGxlciBvZiBoYW5kbGVycyl7XG4gICAgICAgICAgICAgICAgaGFuZGxlcihlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCBhbnlIYW5kbGVycyA9IHRoaXMucmVsZWFzZUxpc3RlbmVyZXMuZ2V0KCdhbnknKTtcbiAgICAgICAgaWYgKGFueUhhbmRsZXJzKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGhhbmRsZXIgb2YgYW55SGFuZGxlcnMpe1xuICAgICAgICAgICAgICAgIGhhbmRsZXIoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgI3VwZGF0ZSgpIHtcbiAgICAgICAgdGhpcy5wcmV2aW91c0J1dHRvbnMgPSBuZXcgTWFwKHRoaXMuYnV0dG9ucyk7XG4gICAgICAgIHRoaXMuYnV0dG9ucy5mb3JFYWNoKChzdGF0ZSwgYnV0dG9uKT0+e1xuICAgICAgICAgICAgaWYgKHN0YXRlID09PSAnZG93bicgJiYgdGhpcy5wcmV2aW91c0J1dHRvbnMuZ2V0KGJ1dHRvbikgPT09ICdkb3duJykge1xuICAgICAgICAgICAgICAgIHRoaXMuYnV0dG9ucy5zZXQoYnV0dG9uLCAncHJlc3NlZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59XG5jbGFzcyBUb3VjaFN5c3RlbSBleHRlbmRzIEMzRXZlbnRzSGFuZGxlciB7XG4gICAgdG91Y2hpbmcgPSBmYWxzZTtcbiAgICB0b3VjaExpc3RlbmVycyA9IG5ldyBNYXAoKTtcbiAgICBtb3ZlSGFuZGxlcnMgPSBuZXcgU2V0KCk7XG4gICAgc3RhcnQgPSBuZXcgUG9zaXRpb24oMCwgMCk7XG4gICAgY3VycmVudCA9IG5ldyBQb3NpdGlvbigwLCAwKTtcbiAgICBwcmV2aW91cyA9IG5ldyBQb3NpdGlvbigwLCAwKTtcbiAgICBlbmQgPSBuZXcgUG9zaXRpb24oMCwgMCk7XG4gICAgY29uc3RydWN0b3IocnVudGltZSl7XG4gICAgICAgIHN1cGVyKHJ1bnRpbWUpO1xuICAgICAgICB0aGlzLm9uKCdwb2ludGVyZG93bicsIChlKT0+dGhpcy4jb25Eb3duKGUpKTtcbiAgICAgICAgdGhpcy5vbigncG9pbnRlcm1vdmUnLCAoZSk9PnRoaXMuI29uTW92ZShlKSk7XG4gICAgICAgIHRoaXMub24oJ3BvaW50ZXJ1cCcsIChlKT0+dGhpcy4jb25VcChlKSk7XG4gICAgfVxuICAgIG9uVG91Y2godHlwZSwgaGFuZGxlcikge1xuICAgICAgICBsZXQgaGFuZGxlcnMgPSB0aGlzLnRvdWNoTGlzdGVuZXJzLmdldCh0eXBlKTtcbiAgICAgICAgaWYgKCFoYW5kbGVycykge1xuICAgICAgICAgICAgdGhpcy50b3VjaExpc3RlbmVycy5zZXQodHlwZSwgbmV3IFNldCgpKTtcbiAgICAgICAgICAgIGhhbmRsZXJzID0gdGhpcy50b3VjaExpc3RlbmVycy5nZXQodHlwZSk7XG4gICAgICAgIH1cbiAgICAgICAgaGFuZGxlcnMuYWRkKGhhbmRsZXIpO1xuICAgICAgICByZXR1cm4gKCk9PntcbiAgICAgICAgICAgIGhhbmRsZXJzLmRlbGV0ZShoYW5kbGVyKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgb25Nb3ZlKGhhbmRsZXIpIHtcbiAgICAgICAgdGhpcy5tb3ZlSGFuZGxlcnMuYWRkKGhhbmRsZXIpO1xuICAgICAgICByZXR1cm4gKCk9PntcbiAgICAgICAgICAgIHRoaXMubW92ZUhhbmRsZXJzLmRlbGV0ZShoYW5kbGVyKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgaXNUb3VjaGluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudG91Y2hpbmc7XG4gICAgfVxuICAgICNvbkRvd24oZSkge1xuICAgICAgICB0aGlzLnN0YXJ0LnggPSBlLmNsaWVudFg7XG4gICAgICAgIHRoaXMuc3RhcnQueSA9IGUuY2xpZW50WTtcbiAgICAgICAgdGhpcy50b3VjaGluZyA9IHRydWU7XG4gICAgICAgIGNvbnN0IGhhbmRsZXJzID0gdGhpcy50b3VjaExpc3RlbmVycy5nZXQoJ3N0YXJ0Jyk7XG4gICAgICAgIGlmICghaGFuZGxlcnMpIHJldHVybjtcbiAgICAgICAgZm9yIChjb25zdCBoYW5kbGVyIG9mIGhhbmRsZXJzKXtcbiAgICAgICAgICAgIGhhbmRsZXIoZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgI29uTW92ZShlKSB7XG4gICAgICAgIHRoaXMucHJldmlvdXMueCA9IHRoaXMuY3VycmVudC54O1xuICAgICAgICB0aGlzLnByZXZpb3VzLnkgPSB0aGlzLmN1cnJlbnQueTtcbiAgICAgICAgdGhpcy5jdXJyZW50LnggPSBlLmNsaWVudFg7XG4gICAgICAgIHRoaXMuY3VycmVudC55ID0gZS5jbGllbnRZO1xuICAgICAgICBmb3IgKGNvbnN0IGhhbmRsZXIgb2YgdGhpcy5tb3ZlSGFuZGxlcnMpe1xuICAgICAgICAgICAgaGFuZGxlcihlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAjb25VcChlKSB7XG4gICAgICAgIHRoaXMuZW5kLnggPSBlLmNsaWVudFg7XG4gICAgICAgIHRoaXMuZW5kLnkgPSBlLmNsaWVudFk7XG4gICAgICAgIHRoaXMudG91Y2hpbmcgPSBmYWxzZTtcbiAgICAgICAgY29uc3QgaGFuZGxlcnMgPSB0aGlzLnRvdWNoTGlzdGVuZXJzLmdldCgnZW5kJyk7XG4gICAgICAgIGlmICghaGFuZGxlcnMpIHJldHVybjtcbiAgICAgICAgZm9yIChjb25zdCBoYW5kbGVyIG9mIGhhbmRsZXJzKXtcbiAgICAgICAgICAgIGhhbmRsZXIoZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5jbGFzcyBNaXNjIHtcbiAgICBsZXJwKGEsIGIsIGMpIHtcbiAgICAgICAgcmV0dXJuIGEgKyAoYiAtIGEpICogYztcbiAgICB9XG4gICAgZ2xvYmFsKHZhck5hbWUsIGRhdGEpIHtcbiAgICAgICAgZ2xvYmFsVGhpc1t2YXJOYW1lXSA9IGRhdGE7XG4gICAgfVxufVxubmV3IE1pc2MoKTtcbmNsYXNzIEFwcCBleHRlbmRzIEMzQXBwIHtcbiAgICBiZWZvcmVTdGFydCgpIHtcbiAgICAgICAgdGhpcy5vbigndGljaycsICgpPT50aGlzLnRpY2soKSk7XG4gICAgfVxuICAgIG9uU3RhcnQoKSB7fVxuICAgIHRpY2soKSB7fVxufVxubGV0IGFwcDtcbnJ1bk9uU3RhcnR1cCgocnVudGltZSk9PntcbiAgICBhcHAgPSBuZXcgQXBwKHJ1bnRpbWUpO1xufSk7XG5leHBvcnQgeyBhcHAgYXMgYXBwIH07XG4iXSwKICAibWFwcGluZ3MiOiAieWhCQUFBLElBQUFBLEVBQUFDLEVBMkJNQyxFQUFOLEtBQXNCLENBR2xCLFlBQVlDLEVBQUksQ0FGaEJDLEVBQUEsS0FBQUosR0FDQUksRUFBQSxLQUFBSCxFQUFVLElBQUksS0FFVkksRUFBQSxLQUFLTCxFQUFPRyxFQUNoQixDQUNBLEdBQUdHLEVBQU9DLEVBQVMsQ0FDZkMsRUFBQSxLQUFLUixHQUFLLGlCQUFpQk0sRUFBT0MsQ0FBTyxFQUN6QyxJQUFJRSxFQUFXRCxFQUFBLEtBQUtQLEdBQVEsSUFBSUssQ0FBSyxFQUNyQyxPQUFLRyxJQUNERCxFQUFBLEtBQUtQLEdBQVEsSUFBSUssRUFBTyxJQUFJLElBQUksQ0FDNUJDLENBQ0osQ0FBQyxDQUFDLEVBQ0ZFLEVBQVdELEVBQUEsS0FBS1AsR0FBUSxJQUFJSyxDQUFLLEdBRXJDRyxFQUFTLElBQUlGLENBQU8sRUFDYixJQUFJLENBQ1BDLEVBQUEsS0FBS1IsR0FBSyxvQkFBb0JNLEVBQU9DLENBQU8sRUFDNUNFLEVBQVMsT0FBT0YsQ0FBTyxFQUNuQkUsRUFBUyxPQUFTLEdBQUdELEVBQUEsS0FBS1AsR0FBUSxPQUFPSyxDQUFLLENBQ3RELENBQ0osQ0FDQSxTQUFVLENBQ04sT0FBVyxDQUFDQSxFQUFPRyxDQUFRLElBQUtELEVBQUEsS0FBS1AsR0FDakMsUUFBV00sS0FBV0UsRUFDbEJELEVBQUEsS0FBS1IsR0FBSyxvQkFBb0JNLEVBQU9DLENBQU8sQ0FHeEQsQ0FDSixFQTVCSVAsRUFBQSxZQUNBQyxFQUFBLFlBN0JKLElBQUFTLEVBQUFDLEVBeURNQyxFQUFOLGNBQW9CVixDQUFnQixDQUdoQyxZQUFZVyxFQUFRLENBQ2hCLE1BQU1BLENBQU8sRUFKckJULEVBQUEsS0FBQU0sR0FDSUksRUFBQSxnQkFDQUEsRUFBQSxvQkFBZSxJQUFJLEtBR2YsS0FBSyxRQUFVRCxFQUNmLEtBQUssR0FBRyxxQkFBc0IsSUFBSSxLQUFLLFlBQVksQ0FBQyxFQUNwRCxLQUFLLEdBQUcsb0JBQXFCLElBQUksS0FBSyxRQUFRLENBQUMsRUFDL0MsS0FBSyxHQUFHLE9BQVEsSUFBSUUsRUFBQSxLQUFLTCxFQUFBQyxHQUFMLFVBQWMsQ0FDdEMsQ0FDQSxPQUFPSixFQUFTLENBQ1osWUFBSyxhQUFhLElBQUlBLENBQU8sRUFDdEIsSUFBSSxDQUNQLEtBQUssYUFBYSxPQUFPQSxDQUFPLENBQ3BDLENBQ0osQ0FDQSxhQUFhUyxFQUFXLENBQ3BCLE9BQVcsQ0FBQ0MsRUFBWUMsQ0FBSyxJQUFLLE9BQU8sUUFBUUYsQ0FBUyxFQUN0RCxLQUFLLFFBQVEsUUFBUUMsQ0FBVSxFQUFFLGlCQUFpQkMsQ0FBSyxDQUUvRCxDQUNBLFlBQVlDLEVBQVUsQ0FDbEIsUUFBV0MsS0FBV0QsRUFDbEIsS0FBSyxRQUFRLElBQUksZUFBZUMsQ0FBTyxDQUUvQyxDQU1KLEVBL0JBVixFQUFBLFlBMEJJQyxFQUFPLFVBQUcsQ0FDTixRQUFXSixLQUFXLEtBQUssYUFDdkJBLEVBQVEsQ0FFaEIsRUEyUkosSUFBTWMsRUFBTixLQUFXLENBQ1AsS0FBS0MsRUFBR0MsRUFBR0MsRUFBRyxDQUNWLE9BQU9GLEdBQUtDLEVBQUlELEdBQUtFLENBQ3pCLENBQ0EsT0FBT0MsRUFBU0MsRUFBTSxDQUNsQixXQUFXRCxDQUFPLEVBQUlDLENBQzFCLENBQ0osRUFDQSxJQUFJTCxFQUNKLElBQU1NLEVBQU4sY0FBa0JDLENBQU0sQ0FDcEIsYUFBYyxDQUNWLEtBQUssR0FBRyxPQUFRLElBQUksS0FBSyxLQUFLLENBQUMsQ0FDbkMsQ0FDQSxTQUFVLENBQUMsQ0FDWCxNQUFPLENBQUMsQ0FDWixFQUNJQyxFQUNKLGFBQWNDLEdBQVUsQ0FDcEJELEVBQU0sSUFBSUYsRUFBSUcsQ0FBTyxDQUN6QixDQUFDIiwKICAibmFtZXMiOiBbIl9yZWYiLCAiX2V2ZW50cyIsICJDM0V2ZW50c0hhbmRsZXIiLCAicmVmIiwgIl9fcHJpdmF0ZUFkZCIsICJfX3ByaXZhdGVTZXQiLCAiZXZlbnQiLCAiaGFuZGxlciIsICJfX3ByaXZhdGVHZXQiLCAiaGFuZGxlcnMiLCAiX0MzQXBwX2luc3RhbmNlcyIsICJvblRpY2tfZm4iLCAiQzNBcHAiLCAicnVudGltZSIsICJfX3B1YmxpY0ZpZWxkIiwgIl9fcHJpdmF0ZU1ldGhvZCIsICJpbnN0YW5jZXMiLCAib2JqZWN0TmFtZSIsICJrbGFzcyIsICJwcm9taXNlcyIsICJwcm9taXNlIiwgIk1pc2MiLCAiYSIsICJiIiwgImMiLCAidmFyTmFtZSIsICJkYXRhIiwgIkFwcCIsICJDM0FwcCIsICJhcHAiLCAicnVudGltZSJdCn0K
